# รายละเอียดการทำงานของโค้ด PDFMapper
โค้ดนี้มีหน้าที่ในการอ่านและเขียน field ต่าง ๆ ที่อยู่ในไฟล์ PDF รวมถึงการสร้างไฟล์ PDF ใหม่ที่มีข้อมูลจาก data_fields มาใส่ลงใน field ต่าง ๆ ของไฟล์ต้นฉบับ แล้วรวมไฟล์ PDF ที่มีข้อมูลเข้ากับไฟล์เทมเพลตเดิม
## ขั้นตอนการทำงาน
### 1, ค้นหาชื่อ field ใน PDF
ใช้ฟังก์ชัน find_form_fields(pdf_path) เพื่อค้นหา field ในไฟล์ PDF โดยใช้ไลบรารี fitz (PyMuPDF) ทำการค้นหา field ต่าง ๆ เช่น ช่องกรอกข้อความ, เช็คบ็อกซ์, ปุ่มตัวเลือก และจะระบุตำแหน่ง (พิกัด) และขนาดของแต่ละ field ลงในรายการ form_fields พร้อมแก้ไขชื่อ field หากพบชื่อซ้ำกัน
### 2. เปลี่ยนชื่อ field 
ฟังก์ชัน change_field_name ใช้สำหรับเปลี่ยนชื่อ field ที่มีชื่อซ้ำกัน เช่นในกรณีที่มีเช็คบ็อกซ์หลายตัวที่ใช้ชื่อเดียวกัน จะเพิ่มเลขต่อท้ายชื่อเช่น field_1, field_2 เพื่อให้สามารถแยกได้
### 3. สร้างไฟล์ PDF ที่มีข้อมูล map ลงใน field 
ฟังก์ชัน create_pdf_with_data ใช้สร้างไฟล์ PDF ที่นำข้อมูลจาก data_fields ไปแทรกลงในตำแหน่ง field ที่กำหนดในไฟล์ PDF โดยมีการจัดรูปแบบข้อความ, รูปภาพ และเช็คบ็อกซ์ตามข้อมูลที่ระบุ
### 4. หา field  checkbox ที่ซ้ำกัน
ฟังก์ชัน process_data_fields ใช้สำหรับจัดการค่า field ที่ซ้ำกัน โดยเฉพาะ field ที่เป็นเช็คบ็อกซ์ เพื่อให้ field หลักและ field ย่อยที่มี suffix (เช่น _1, _2) ทำงานสัมพันธ์กัน
### 5. รวม PDF template กับ PDF data
ฟังก์ชัน merge_pages ใช้สำหรับรวมไฟล์ PDF ที่มีข้อมูลที่แทรกลงใน field กับไฟล์เทมเพลตต้นฉบับเข้าด้วยกัน โดยหน้าของทั้งสองไฟล์จะถูกซ้อนทับและรวมเป็นไฟล์เดียว
